# SortMeDown & BangBang

<div align="center">

```
    ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñí‚ñà‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà‚ñÄ‚ñà‚ñà‚ñà  ‚ñÑ‚ñÑ‚ñÑ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì    ‚ñà‚ñà‚ñà‚ñÑ ‚ñÑ‚ñà‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà    ‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñÑ  ‚ñí‚ñà‚ñà‚ñà‚ñà‚ñà   ‚ñà     ‚ñà‚ñë‚ñà‚ñà‚ñà‚ñÑ    ‚ñà 
  ‚ñí‚ñà‚ñà    ‚ñí ‚ñí‚ñà‚ñà‚ñí  ‚ñà‚ñà‚ñí‚ñì‚ñà‚ñà ‚ñí ‚ñà‚ñà‚ñí‚ñì  ‚ñà‚ñà‚ñí ‚ñì‚ñí   ‚ñì‚ñà‚ñà‚ñí‚ñÄ‚ñà‚ñÄ ‚ñà‚ñà‚ñí‚ñì‚ñà   ‚ñÄ    ‚ñí‚ñà‚ñà‚ñÄ ‚ñà‚ñà‚ñå‚ñí‚ñà‚ñà‚ñí  ‚ñà‚ñà‚ñí‚ñì‚ñà‚ñë ‚ñà ‚ñë‚ñà‚ñë‚ñà‚ñà ‚ñÄ‚ñà   ‚ñà 
  ‚ñë ‚ñì‚ñà‚ñà‚ñÑ   ‚ñí‚ñà‚ñà‚ñë  ‚ñà‚ñà‚ñí‚ñì‚ñà‚ñà ‚ñë‚ñÑ‚ñà ‚ñí‚ñí ‚ñì‚ñà‚ñà‚ñë ‚ñí‚ñë   ‚ñì‚ñà‚ñà    ‚ñì‚ñà‚ñà‚ñë‚ñí‚ñà‚ñà‚ñà      ‚ñë‚ñà‚ñà   ‚ñà‚ñå‚ñí‚ñà‚ñà‚ñë  ‚ñà‚ñà‚ñí‚ñí‚ñà‚ñë ‚ñà ‚ñë‚ñà‚ñì‚ñà‚ñà  ‚ñÄ‚ñà ‚ñà‚ñà‚ñí
    ‚ñí   ‚ñà‚ñà‚ñí‚ñí‚ñà‚ñà   ‚ñà‚ñà‚ñë‚ñí‚ñà‚ñà‚ñÄ‚ñÄ‚ñà‚ñÑ  ‚ñë ‚ñì‚ñà‚ñà‚ñì ‚ñë    ‚ñí‚ñà‚ñà    ‚ñí‚ñà‚ñà ‚ñí‚ñì‚ñà  ‚ñÑ    ‚ñë‚ñì‚ñà‚ñÑ   ‚ñå‚ñí‚ñà‚ñà   ‚ñà‚ñà‚ñë‚ñë‚ñà‚ñë ‚ñà ‚ñë‚ñà‚ñì‚ñà‚ñà‚ñí  ‚ñê‚ñå‚ñà‚ñà‚ñí
  ‚ñí‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñí‚ñí‚ñë ‚ñà‚ñà‚ñà‚ñà‚ñì‚ñí‚ñë‚ñë‚ñà‚ñà‚ñì ‚ñí‚ñà‚ñà‚ñí  ‚ñí‚ñà‚ñà‚ñí ‚ñë    ‚ñí‚ñà‚ñà‚ñí   ‚ñë‚ñà‚ñà‚ñí‚ñë‚ñí‚ñà‚ñà‚ñà‚ñà‚ñí   ‚ñë‚ñí‚ñà‚ñà‚ñà‚ñà‚ñì ‚ñë ‚ñà‚ñà‚ñà‚ñà‚ñì‚ñí‚ñë‚ñë‚ñë‚ñà‚ñà‚ñí‚ñà‚ñà‚ñì‚ñí‚ñà‚ñà‚ñë   ‚ñì‚ñà‚ñà‚ñë
  ‚ñí ‚ñí‚ñì‚ñí ‚ñí ‚ñë‚ñë ‚ñí‚ñë‚ñí‚ñë‚ñí‚ñë ‚ñë ‚ñí‚ñì ‚ñë‚ñí‚ñì‚ñë  ‚ñí ‚ñë‚ñë      ‚ñë ‚ñí‚ñë   ‚ñë  ‚ñë‚ñë‚ñë ‚ñí‚ñë ‚ñë    ‚ñí‚ñí‚ñì  ‚ñí ‚ñë ‚ñí‚ñë‚ñí‚ñë‚ñí‚ñë ‚ñë ‚ñì‚ñë‚ñí ‚ñí ‚ñë ‚ñí‚ñë   ‚ñí ‚ñí 
  ‚ñë ‚ñë‚ñí  ‚ñë ‚ñë  ‚ñë ‚ñí ‚ñí‚ñë   ‚ñë‚ñí ‚ñë ‚ñí‚ñë    ‚ñë       ‚ñë  ‚ñë      ‚ñë ‚ñë ‚ñë  ‚ñë    ‚ñë ‚ñí  ‚ñí   ‚ñë ‚ñí ‚ñí‚ñë   ‚ñí ‚ñë ‚ñë ‚ñë ‚ñë‚ñë   ‚ñë ‚ñí‚ñë
  ‚ñë  ‚ñë  ‚ñë  ‚ñë ‚ñë ‚ñë ‚ñí    ‚ñë‚ñë   ‚ñë   ‚ñë         ‚ñë      ‚ñë      ‚ñë       ‚ñë ‚ñë  ‚ñë ‚ñë ‚ñë ‚ñë ‚ñí    ‚ñë   ‚ñë    ‚ñë   ‚ñë ‚ñë 
        ‚ñë      ‚ñë ‚ñë      ‚ñë                        ‚ñë      ‚ñë  ‚ñë      ‚ñë        ‚ñë ‚ñë      ‚ñë        ‚ñë   
                     CLI Media Sorter Script                                           v6.0.1
```

**A powerful, configurable media sorter with both GUI and CLI interfaces**

![Python](https://img.shields.io/badge/python-3.9+-blue.svg?style=flat-square&logo=python&logoColor=white)
[![License](https://img.shields.io/badge/License-Apache_2.0-green.svg?style=flat-square)](https://opensource.org/licenses/Apache-2.0)
![Platform](https://img.shields.io/badge/platform-Windows%20|%20macOS%20|%20Linux-lightgrey.svg?style=flat-square)
![Status](https://img.shields.io/badge/status-Active-brightgreen.svg?style=flat-square)

</div>

---

## üåü Overview

SortMeDown automatically organizes your movies, TV shows, and anime into a clean, structured library. It fetches metadata from OMDb and AniList to correctly identify and rename your files, then moves them to your specified library directories with intelligent conflict resolution.

## ‚ú® Key Features

<table>
<tr>
<td width="50%">

### üéØ **Smart Organization**
- ü§ñ **Automatic Detection** - Movies, TV Series, Anime Movies & Series
- üß† **Intelligent Conflict Resolution** - Compares filenames to API results
- üìÇ **Configurable Fallbacks** - Handle mismatched files your way
- üá´üá∑ **Language Support** - Route French content to dedicated directories

</td>
<td width="50%">

### üöÄ **Powerful Interfaces**
- üé≠ **Dual Modes** - GUI for ease, CLI for power users
- ‚è±Ô∏è **Watch Mode** - Monitor folders for new files automatically
- üß™ **Dry-Run Mode** - Preview operations safely
- üõ†Ô∏è **Clean Architecture** - UI-agnostic core engine

</td>
</tr>
</table>

---

## üì∏ Screenshots

### GUI Interface
<p align="center">
  <img src="https://github.com/user-attachments/assets/5cd92668-bc3a-4c7d-a6d1-3fb3febc43a1" width="200" />
  <img src="https://github.com/user-attachments/assets/44c92305-601b-4c2d-afac-fe54bf72c53c" width="200" />
  <img src="https://github.com/user-attachments/assets/d5a7fdc6-b3ce-4416-a8c9-cef841d5ee8a" width="100" />
  <img src="https://github.com/user-attachments/assets/38579906-235b-483d-8346-e55b517cb6a4" width="100" />
  <img src="https://github.com/user-attachments/assets/3ce4339b-1744-4d19-9109-dd9333074d13" width="100" />
</p>

### CLI Interface
<div align="center">

<img width="724" alt="CLI Interface" src="https://github.com/user-attachments/assets/2e422370-5867-411b-8d40-b1cd48d12f8a" />

</div>

---

## üöÄ Quick Start

### 1Ô∏è‚É£ Clone & Install

```bash
# Clone the repository
git clone https://github.com/Frederic-LM/Sort-Me-Down.git
cd Sort-Me-Down

# Install dependencies
pip install -r requirements.txt
```

### 2Ô∏è‚É£ Get Your API Key

> üîë **Free OMDb API Key Required**
> 
> 1. Visit [omdbapi.com/apikey.aspx](http://www.omdbapi.com/apikey.aspx)
> 2. Select the **FREE** plan
> 3. Enter your email
> 4. Check your inbox for the API key

### 3Ô∏è‚É£ Initial Configuration

```bash
# Run once to create default config
python gui.py
# OR
python cli.py
```

### 4Ô∏è‚É£ Configure Your Paths

Edit the generated `config.json`:

```json
{
    "SOURCE_DIR": "C:/Path/To/Your/Downloads",
    "MOVIES_DIR": "D:/Media/Movies",
    "TV_SHOWS_DIR": "D:/Media/TV Shows",
    "ANIME_MOVIES_DIR": "D:/Media/Anime Movies",
    "ANIME_SERIES_DIR": "D:/Media/Anime Series",
    "MISMATCHED_DIR": "C:/Path/To/Your/Downloads/_Mismatched",
    "OMDB_API_KEY": "your_omdb_api_key_here"
}
```

> üí° **Windows Users**: Use forward slashes `/` or double backslashes `\\` in paths

---

## üéÆ Usage

### üñºÔ∏è Graphical Interface

Perfect for beginners and occasional users:

```bash
python gui.py
```

**Features:**
- **Actions Tab** - Start sorting, enable watch mode, configure fallbacks
- **Settings Tab** - Manage library paths, API keys, and advanced options
- **Real-time Status** - See what's happening as it happens

### üíª Command Line Interface

Ideal for power users and automation:

#### Basic Commands

```bash
# One-time sort using config.json settings
python cli.py sort

# Monitor directory for new files
python cli.py watch

# Preview operations without moving files
python cli.py sort --dry-run
```

#### Advanced Usage

<details>
<summary><strong>üìñ Click to expand full CLI reference</strong></summary>

### Global Arguments
| Argument | Description | Example |
|----------|-------------|---------|
| `--help` | Show help message | `python cli.py sort --help` |
| `--version` | Show program version | `python cli.py --version` |
| `--config [PATH]` | Use specific config file | `python cli.py sort --config /path/to/config.json` |

### Sort Command Options
```bash
python cli.py sort [OPTIONS]
```

| Argument | Description | Example |
|----------|-------------|---------|
| `--dry-run` | Simulate without moving files | `python cli.py sort --dry-run` |
| `--tmdb` | Use TMDB as primary API | `python cli.py sort --tmdb` |
| `--split-languages` | Split languages into folders | `python cli.py sort --split-languages "fr,de"` |
| `--cleanup-in-place` | Organize within source folder | `python cli.py sort --cleanup-in-place` |
| `--mismatched-dir` | Override mismatched directory | `python cli.py sort --mismatched-dir "D:/Review"` |
| `--fallback [choice]` | Fallback behavior for mismatches | `python cli.py sort --fallback tv` |

### Watch Command Options
```bash
python cli.py watch [OPTIONS]
```

| Argument | Description | Example |
|----------|-------------|---------|
| `--dry-run` | Run watchdog in simulation mode | `python cli.py watch --dry-run` |
| `--watch-interval [MIN]` | Override check interval | `python cli.py watch --watch-interval 5` |

</details>

---

## ‚öôÔ∏è Configuration

<details>
<summary><strong>üîß Click to see all configuration options</strong></summary>

### Core Settings
- **`SOURCE_DIR`** - Folder with unsorted media
- **`MOVIES_DIR`** - Destination for movies
- **`TV_SHOWS_DIR`** - Destination for TV series
- **`ANIME_MOVIES_DIR`** - Destination for anime movies
- **`ANIME_SERIES_DIR`** - Destination for anime series
- **`MISMATCHED_DIR`** - Files with conflicting metadata

### API & Behavior
- **`OMDB_API_KEY`** - Your OMDb API key
- **`FALLBACK_SHOW_DESTINATION`** - Default for mismatched shows (`"ignore"`, `"mismatched"`, `"tv"`, or `"anime"`)

### File Types
- **`SUPPORTED_EXTENSIONS`** - Primary media file types
- **`SIDECAR_EXTENSIONS`** - Files to move with media (subtitles, posters, etc.)

</details>

---

## üì¶ Building Executables

<details>
<summary><strong>üèóÔ∏è Create standalone executables</strong></summary>

### Prerequisites
```bash
pip install pyinstaller
pip install -r requirements.txt
```

### Windows (.exe)
```bash
pyinstaller --onefile --windowed --hidden-import="pystray._win32" --add-data "icon.ico;." --add-data "icon.png;." --icon="icon.ico" --name="Sort-Me-Down" gui.py
```

### macOS (.app)
> ‚ö†Ô∏è **Must be compiled on macOS**

```bash
pyinstaller --onefile --windowed --name="Sort-Me-Down" --hidden-import="pystray._win32" --icon="icon.ico" --add-data="icon.ico;." --add-data="icon.png;." gui.py

```

> üõ°Ô∏è **macOS Security**: First run requires right-click ‚Üí "Open" to bypass Gatekeeper

</details>

---

## ü§ñ Running as a Service/Daemon

<details>
<summary><strong>‚öôÔ∏è Set up automatic background processing</strong></summary>

### Linux/macOS (systemd)

Create `/etc/systemd/system/sortmedown.service`:

```ini
[Unit]
Description=SortMeDown Media Sorter
After=network.target

[Service]
User=your_username
Group=your_username
WorkingDirectory=/path/to/sortmedown/
ExecStart=/path/to/python /path/to/cli.py watch
Restart=on-failure
RestartSec=30
SyslogIdentifier=sortmedown

[Install]
WantedBy=multi-user.target
```

**Manage the service:**
```bash
sudo systemctl daemon-reload
sudo systemctl enable sortmedown.service
sudo systemctl start sortmedown.service
sudo systemctl status sortmedown.service
```

### Windows (NSSM)

1. **Download [NSSM](https://nssm.cc/download)**
2. **Install as service:**
   ```cmd
   nssm.exe install SortMeDown
   ```
3. **Configure in the GUI:**
   - **Path**: Your Python executable
   - **Arguments**: `cli.py watch --config "C:\path\to\config.json"`
   - **Startup directory**: Your project folder

**Manage the service:**
```cmd
sc start SortMeDown
sc stop SortMeDown
sc query SortMeDown
```

</details>

---

## üõ°Ô∏è File Safety

### How SortMeDown Handles Active Downloads

<details>
<summary><strong>üîí Click to understand the safety mechanisms</strong></summary>

**The Most Common (Safe) Scenario:**

1. **Download in Progress** ‚Üí OS locks the file
2. **SortMeDown Scans** ‚Üí Finds and classifies the file
3. **Move Attempt** ‚Üí OS denies access (file locked)
4. **Graceful Handling** ‚Üí Error logged, file skipped
5. **Download Completes** ‚Üí Lock released
6. **Next Scan** ‚Üí File successfully processed

**Key Safety Features:**
- ‚úÖ **OS File Locking** - Prevents moving incomplete files
- ‚úÖ **Error Handling** - Gracefully handles locked files
- ‚úÖ **Retry Logic** - Picks up files on subsequent scans
- ‚úÖ **Detailed Logging** - Track what happens and why

**Why No "Stale File" Check?**
SortMeDown prioritizes **maximum throughput** over additional safety checks, relying on robust OS-level file locking for protection. This approach handles 99% of real-world scenarios effectively.

</details>

---

## üÜò Troubleshooting

<details>
<summary><strong>üêõ Common issues and solutions</strong></summary>

### API Issues
- **"Invalid API Key"** ‚Üí Verify your OMDb key in `config.json`
- **"API Limit Exceeded"** ‚Üí Wait for reset or upgrade your OMDb plan

### File Operations
- **"Permission Denied"** ‚Üí Check folder permissions and file locks
- **"Path Not Found"** ‚Üí Verify all paths in `config.json` exist

### Configuration
- **"Config Not Found"** ‚Üí Run the application once to generate default config
- **Windows Path Issues** ‚Üí Use forward slashes `/` or double backslashes `\\`

### Performance
- **Slow Processing** ‚Üí API rate limits are normal, consider TMDB option
- **High Memory Usage** ‚Üí Large directories may require system resources

</details>

---

## üìÑ License

This project is licensed under the **Apache License 2.0** - see the [LICENSE](LICENSE) file for details.

---

<div align="center">

**Made with ‚ù§Ô∏è for media enthusiasts**

[Report Bug](https://github.com/Frederic-LM/Sort-Me-Down/issues) ¬∑ [Request Feature](https://github.com/Frederic-LM/Sort-Me-Down/issues) ¬∑ [Contribute](https://github.com/Frederic-LM/Sort-Me-Down/pulls)

</div>
